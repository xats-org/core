{
  "schemaVersion": "0.2.0",
  "bibliographicEntry": {
    "id": "intro-chemistry-2024",
    "type": "book",
    "title": "Introduction to Chemistry with LTI Integration",
    "author": [
      {
        "given": "Sarah",
        "family": "Johnson"
      }
    ],
    "publisher": "Educational Publishing Co.",
    "issued": { "date-parts": [[2024]] },
    "ISBN": "978-1-234-56789-0"
  },
  "subject": "Chemistry",
  "targetAudience": "Undergraduate students",
  "extensions": {
    "ltiConfiguration": {
      "toolTitle": "xats Chemistry Textbook",
      "toolDescription": "Interactive chemistry textbook with assessments and adaptive pathways",
      "toolVersion": "2.0.1",
      "toolUrl": "https://textbooks.example.edu",
      "launchUrl": "https://textbooks.example.edu/lti/launch",
      "loginInitiationUrl": "https://textbooks.example.edu/lti/login",
      "redirectUris": [
        "https://textbooks.example.edu/lti/launch",
        "https://textbooks.example.edu/lti/deep-linking"
      ],
      "jwksUrl": "https://textbooks.example.edu/.well-known/jwks.json",
      "customParameters": {
        "textbook_id": "$ResourceLink.id",
        "course_context": "$CourseOffering.id",
        "institution": "$ToolConsumerInstance.id"
      },
      "privacyLevel": "email_only",
      "supportedServices": [
        "https://purl.imsglobal.org/spec/lti-ags/scope/lineitem",
        "https://purl.imsglobal.org/spec/lti-ags/scope/score",
        "https://purl.imsglobal.org/spec/lti-ags/scope/result.readonly",
        "https://purl.imsglobal.org/spec/lti-dl/scope/deeplinking"
      ],
      "targetLinkUri": "https://textbooks.example.edu/chemistry/intro",
      "platformRegistrations": [
        {
          "platformId": "https://canvas.university.edu",
          "clientId": "125900000000000001",
          "deploymentIds": ["1:dce74908-8e4a-4cc7-8a94-4b4b7d8b8f8f"],
          "keySetUrl": "https://canvas.university.edu/api/lti/security/jwks",
          "authTokenUrl": "https://canvas.university.edu/login/oauth2/token",
          "authLoginUrl": "https://canvas.university.edu/api/lti/authorize_redirect",
          "serviceEndpoints": {
            "lineitemsUrl": "https://canvas.university.edu/api/lti/courses/123/line_items",
            "scopes": [
              "https://purl.imsglobal.org/spec/lti-ags/scope/lineitem",
              "https://purl.imsglobal.org/spec/lti-ags/scope/score",
              "https://purl.imsglobal.org/spec/lti-dl/scope/deeplinking"
            ]
          }
        }
      ]
    }
  },
  "bodyMatter": {
    "contents": [
      {
        "id": "chapter-1",
        "language": "en",
        "title": "Atomic Structure and Bonding",
        "label": "Chapter 1",
        "extensions": {
          "ltiDeepLinking": {
            "enabled": true,
            "acceptTypes": ["ltiResourceLink"],
            "title": "Select Chemistry Content",
            "text": "Choose from interactive lessons and assessments on atomic structure",
            "contentItems": [
              {
                "type": "ltiResourceLink",
                "title": "Interactive Atomic Models",
                "text": "3D visualization of atomic structure",
                "url": "https://textbooks.example.edu/chemistry/atomic-models",
                "xatsResourceId": "atomic-models-section"
              },
              {
                "type": "ltiResourceLink", 
                "title": "Bonding Assessment",
                "text": "Comprehensive assessment on chemical bonding",
                "url": "https://textbooks.example.edu/chemistry/bonding-quiz",
                "lineItem": {
                  "scoreMaximum": 100,
                  "label": "Chemical Bonding Quiz",
                  "tag": "bonding-assessment"
                },
                "xatsResourceId": "bonding-assessment"
              }
            ]
          }
        },
        "sections": [
          {
            "id": "atomic-models-section",
            "language": "en",
            "title": "Atomic Models",
            "extensions": {
              "ltiLaunchMetadata": {
                "resourceLinkTitle": "Interactive Atomic Models",
                "resourceLinkDescription": "3D visualization and manipulation of atomic structure",
                "targetLinkUri": "https://textbooks.example.edu/chemistry/atomic-models",
                "presentationHints": {
                  "documentTarget": "iframe",
                  "displayWidth": 800,
                  "displayHeight": 600
                }
              }
            },
            "content": [
              {
                "id": "atomic-theory-intro",
                "language": "en",
                "blockType": "https://xats.org/core/blocks/paragraph",
                "content": {
                  "text": {
                    "runs": [
                      {
                        "type": "text",
                        "text": "The modern understanding of atomic structure has evolved through several key models, from Dalton's solid sphere to the quantum mechanical model."
                      }
                    ]
                  }
                }
              }
            ]
          },
          {
            "id": "bonding-concepts",
            "language": "en", 
            "title": "Chemical Bonding Concepts",
            "content": [
              {
                "id": "bonding-assessment",
                "language": "en",
                "blockType": "https://xats.org/core/blocks/multipleChoice",
                "extensions": {
                  "ltiGradePassback": {
                    "enabled": true,
                    "lineItemConfig": {
                      "scoreMaximum": 100,
                      "label": "Chemical Bonding Quiz - Chapter 1",
                      "tag": "ch1-bonding-quiz",
                      "resourceId": "bonding-assessment"
                    },
                    "scoreFormat": "percentage",
                    "includeMetadata": {
                      "timestamp": true,
                      "activityProgress": true,
                      "gradingProgress": true,
                      "comment": true
                    }
                  },
                  "ltiLaunchMetadata": {
                    "resourceLinkTitle": "Chemical Bonding Assessment",
                    "customParameters": {
                      "assessment_type": "formative",
                      "chapter": "1",
                      "topic": "bonding"
                    }
                  }
                },
                "content": {
                  "question": {
                    "runs": [
                      {
                        "type": "text",
                        "text": "Which type of chemical bond involves the sharing of electron pairs between atoms?"
                      }
                    ]
                  },
                  "options": [
                    {
                      "id": "option-a",
                      "text": {
                        "runs": [{"type": "text", "text": "Ionic bond"}]
                      },
                      "correct": false
                    },
                    {
                      "id": "option-b", 
                      "text": {
                        "runs": [{"type": "text", "text": "Covalent bond"}]
                      },
                      "correct": true
                    },
                    {
                      "id": "option-c",
                      "text": {
                        "runs": [{"type": "text", "text": "Metallic bond"}]
                      },
                      "correct": false
                    },
                    {
                      "id": "option-d",
                      "text": {
                        "runs": [{"type": "text", "text": "Hydrogen bond"}]
                      },
                      "correct": false
                    }
                  ],
                  "multipleCorrect": false,
                  "cognitiveMetadata": {
                    "bloomsLevel": "understand",
                    "difficulty": 2,
                    "estimatedTimeMinutes": 2
                  },
                  "scoring": {
                    "points": 10,
                    "scoringMethod": "automatic",
                    "partialCredit": false,
                    "attempts": 3,
                    "penaltyPerAttempt": 0.1
                  },
                  "feedback": {
                    "onCorrect": {
                      "runs": [
                        {
                          "type": "text",
                          "text": "Correct! Covalent bonds form when atoms share electrons to achieve stable electron configurations."
                        }
                      ]
                    },
                    "onIncorrect": {
                      "runs": [
                        {
                          "type": "text", 
                          "text": "Not quite. Review the different types of chemical bonds and how electrons behave in each."
                        }
                      ]
                    }
                  }
                }
              }
            ]
          }
        ],
        "pathways": [
          {
            "trigger": {
              "triggerType": "https://xats.org/core/triggers/onAssessment",
              "sourceId": "bonding-assessment"
            },
            "extensions": {
              "ltiPathwayIntegration": {
                "useGradeData": true,
                "gradeVariables": {
                  "scorePercentage": "lti_score_percentage",
                  "attempts": "lti_attempts",
                  "activityProgress": "lti_activity_progress"
                },
                "conditionExamples": [
                  {
                    "description": "High achiever path using LTI grade data",
                    "condition": "lti_score_percentage >= 90 AND lti_attempts == 1"
                  },
                  {
                    "description": "Remediation path for struggling students", 
                    "condition": "lti_score_percentage < 70 OR lti_attempts >= 2"
                  }
                ]
              }
            },
            "rules": [
              {
                "condition": "lti_score_percentage >= 85 AND lti_attempts == 1",
                "destinationId": "advanced-bonding-concepts",
                "pathwayType": "https://xats.org/core/pathways/enrichment"
              },
              {
                "condition": "lti_score_percentage >= 70 AND lti_score_percentage < 85",
                "destinationId": "chapter-2",
                "pathwayType": "https://xats.org/core/pathways/standard"
              },
              {
                "condition": "lti_score_percentage < 70 OR lti_attempts >= 2",
                "destinationId": "bonding-review-section",
                "pathwayType": "https://xats.org/core/pathways/remedial"
              }
            ]
          }
        ]
      }
    ]
  }
}